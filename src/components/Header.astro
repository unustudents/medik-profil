---
import { ADDRESS, CONTACTS, MENU } from "@/consts";
import { Image } from "astro:assets";
import { logo } from "@/assets";
---

<header
	class="bg-white/80 backdrop-blur-sm dark:bg-slate-900/80 dark:backdrop-blur-sm border-b border-slate-200 dark:border-slate-800 sticky top-0 z-50 transition-colors duration-300"
>
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
		<div
			class="flex items-center justify-between py-3 border-b border-slate-100 dark:border-slate-800 hidden lg:flex"
		>
			<div class="flex items-center space-x-6">
				<div class="flex items-center space-x-2">
					<span class="material-icons-outlined text-primary"
						>location_on</span
					>
					<div class="text-[10px] leading-tight">
						<p class="font-bold text-slate-400 uppercase">
							Alamat / Address
						</p>
						<p class="text-slate-600 dark:text-slate-300">
							{ADDRESS}
						</p>
					</div>
				</div>
				<div
					class="flex items-center space-x-2 border-l border-slate-200 dark:border-slate-700 pl-6"
				>
					<span class="material-icons-outlined text-primary"
						>schedule</span
					>
					<div class="text-[10px] leading-tight">
						<p class="font-bold text-slate-400 uppercase">
							Selasa, 27 Jan 2026
						</p>
						<p class="text-slate-600 dark:text-slate-300 font-bold">
							08:00 - 22:00 <span
								class="bg-primary text-white px-1 rounded text-[8px]"
								>WIB</span
							>
						</p>
					</div>
				</div>
			</div>
			<div class="flex items-center space-x-2">
				<span class="material-icons-outlined text-primary"
					>phone_in_talk</span
				>
				<div class="text-[10px] leading-tight">
					<p class="font-bold text-slate-400 uppercase">
						Darurat / UGD
					</p>
					<p class="text-primary font-bold text-base leading-none">
						{CONTACTS.igd}
					</p>
				</div>
			</div>
		</div>
		<nav class="flex items-center justify-between py-4">
			<div class="flex items-center space-x-8">
				<div class="flex items-center space-x-2">
					<!-- <div
						class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center"
					>
						<span class="material-icons-outlined text-white"
							>medical_services</span
						>
					</div>
					<span class="text-xl font-bold text-primary tracking-tight"
						>RSU Afdila</span
					> -->
					<a href="/">
						<Image
							src={logo}
							alt="RSU Afdila Logo"
							class="h-10 w-auto"
						/>
					</a>
				</div>

				<!-- Desktop Menu -->
				<div class="hidden lg:flex space-x-6 text-sm font-medium">
					{
						MENU.map((item) =>
							item.subItems ? (
								<div class="relative group">
									<button class="flex items-center gap-1 hover:text-primary transition-colors focus:outline-none text-slate-700 dark:text-slate-200">
										{item.name}
										<span class="material-icons-outlined text-sm transition-transform group-hover:rotate-180">
											expand_more
										</span>
									</button>
									<div class="absolute top-full left-0 pt-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 transform translate-y-2 group-hover:translate-y-0 z-50 w-56">
										<div class="bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-100 dark:border-slate-800 overflow-hidden py-2">
											{item.subItems.map((subItem) => (
												<a
													href={subItem.href}
													class="block px-4 py-2 hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300 hover:text-primary dark:hover:text-primary transition-colors"
												>
													{subItem.name}
												</a>
											))}
										</div>
									</div>
								</div>
							) : (
								<a
									class="hover:text-primary transition-colors text-slate-700 dark:text-slate-200"
									href={item.href}
								>
									{item.name}
								</a>
							),
						)
					}
				</div>
			</div>
			<div class="flex items-center space-x-4">
				<div class="relative hidden sm:block">
					<input
						class="pl-4 pr-10 py-2 rounded-full border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"
						placeholder="Search Doctor..."
						type="text"
					/>
					<span
						class="material-icons-outlined absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm"
						>search</span
					>
				</div>
				<button
					id="mobile-menu-btn"
					class="bg-primary text-white p-2 rounded-lg lg:hidden hover:bg-primary/90 transition-colors"
				>
					<span class="material-icons-outlined">menu</span>
				</button>
			</div>
		</nav>

		<!-- Mobile Menu -->
		<div
			id="mobile-menu"
			class="absolute top-full left-0 right-0 lg:hidden bg-white dark:bg-slate-900 border-t border-slate-200 dark:border-slate-800 shadow-lg transform scale-y-0 origin-top transition-transform duration-300 ease-in-out z-40 max-h-[calc(100vh-100px)] overflow-y-auto"
		>
			<div class="px-4 py-4 space-y-2">
				{
					MENU.map((item) =>
						item.subItems ? (
							<div class="space-y-1">
								<button class="mobile-dropdown-btn w-full flex items-center justify-between px-4 py-2 rounded-lg text-slate-700 dark:text-slate-200 hover:bg-primary/10 hover:text-primary font-medium transition-colors">
									<span>{item.name}</span>
									<span class="material-icons-outlined text-sm transition-transform duration-300 mobile-dropdown-icon">
										expand_more
									</span>
								</button>
								<div class="mobile-dropdown-content hidden pl-4 space-y-1 bg-slate-50 dark:bg-slate-800/50 rounded-lg mx-2 py-2">
									{item.subItems.map((subItem) => (
										<a
											href={subItem.href}
											class="block px-4 py-2 text-sm text-slate-600 dark:text-slate-400 hover:text-primary transition-colors"
										>
											{subItem.name}
										</a>
									))}
								</div>
							</div>
						) : (
							<a
								href={item.href}
								class="block px-4 py-2 rounded-lg text-slate-700 dark:text-slate-200 hover:bg-primary/10 hover:text-primary font-medium transition-colors"
							>
								{item.name}
							</a>
						),
					)
				}
			</div>
		</div>
	</div>
</header>

<script>
	// Constants
	const mobileMenuBtn = document.getElementById("mobile-menu-btn");
	const mobileMenu = document.getElementById("mobile-menu");
	const mobileDropdownBtns = document.querySelectorAll(
		".mobile-dropdown-btn",
	);

	// Toggle Mobile Menu
	if (mobileMenuBtn && mobileMenu) {
		mobileMenuBtn.addEventListener("click", () => {
			const isExpanded = mobileMenu.classList.contains("scale-y-100");
			if (isExpanded) {
				mobileMenu.classList.remove("scale-y-100");
				mobileMenu.classList.add("scale-y-0");
			} else {
				mobileMenu.classList.remove("scale-y-0");
				mobileMenu.classList.add("scale-y-100");
			}
		});
	}

	// Toggle Mobile Dropdown (Accordion)
	if (mobileDropdownBtns) {
		mobileDropdownBtns.forEach((btn) => {
			btn.addEventListener("click", (e) => {
				e.stopPropagation();
				const content = btn.nextElementSibling;
				const icon = btn.querySelector(".mobile-dropdown-icon");

				if (content && icon) {
					content.classList.toggle("hidden");
					icon.classList.toggle("rotate-180");
				}
			});
		});
	}

	// Close menu when clicking outside
	document.addEventListener("click", (e) => {
		if (
			mobileMenu &&
			mobileMenuBtn &&
			!mobileMenu.contains(e.target as Node) &&
			!mobileMenuBtn.contains(e.target as Node)
		) {
			mobileMenu.classList.remove("scale-y-100");
			mobileMenu.classList.add("scale-y-0");
		}
	});
</script>
